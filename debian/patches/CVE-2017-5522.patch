Description: security fix (patch by EvenR)
 Fixes CVE-2017-5522 (stack buffer overflow)
Author: Even Rouault <even.rouault@spatialys.com>
Origin: https://github.com/mapserver/mapserver/commit/cf7a13e62e5c56e4c7f455c1c38037a96dd1019d

--- a/mapogcfilter.c
+++ b/mapogcfilter.c
@@ -2874,6 +2874,9 @@ char *FLTGetIsLikeComparisonExpression(F
 
     pszValue = psFilterNode->psRightNode->pszValue;
     nLength = strlen(pszValue);
+
+    if( 1 + 2 * nLength + 1 + 1 >= sizeof(szTmp) )
+        return NULL;
     
     iTmp =0;
     if (nLength > 0 && pszValue[0] != pszWild[0] && 
--- a/mapogcfiltercommon.c
+++ b/mapogcfiltercommon.c
@@ -146,6 +146,9 @@ char *FLTGetIsLikeComparisonCommonExpres
 
     pszValue = psFilterNode->psRightNode->pszValue;
     nLength = strlen(pszValue);
+
+    if( 1 + 2 * nLength + 1 + 1 >= sizeof(szTmp) )
+        return NULL;
     
     iTmp =0;
     if (nLength > 0 && pszValue[0] != pszWild[0] && 
