Description: security fix (patch by EvenR)
 Fixes CVE-2017-5522 (stack buffer overflow)
Author: Even Rouault <even.rouault@spatialys.com>
Origin: https://github.com/mapserver/mapserver/commit/e52a436c0e1c5e9f7ef13428dba83194a800f4df

--- a/mapogcfilter.c
+++ b/mapogcfilter.c
@@ -3004,6 +3004,8 @@ char *FLTGetIsLikeComparisonExpression(F
 
   pszValue = psFilterNode->psRightNode->pszValue;
   nLength = strlen(pszValue);
+  if( 1 + 2 * nLength + 1 + 1 >= sizeof(szTmp) )
+      return NULL;
 
   iTmp =0;
   if (nLength > 0 && pszValue[0] != pszWild[0] &&
--- a/mapogcfiltercommon.c
+++ b/mapogcfiltercommon.c
@@ -88,6 +88,8 @@ char *FLTGetIsLikeComparisonCommonExpres
 
   pszValue = psFilterNode->psRightNode->pszValue;
   nLength = strlen(pszValue);
+  if( 1 + 2 * nLength + 1 + 1 >= sizeof(szTmp) )
+      return NULL;
 
   iTmp =0;
   if (nLength > 0 && pszValue[0] != pszWild[0] && pszValue[0] != pszSingle[0] && pszValue[0] != pszEscape[0]) {
